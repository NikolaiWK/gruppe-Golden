<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
    <script type="text/javascript" src="../d3.js"></script>
</head>
<body>
  
  <div class="bg-image"></div>
  <h1>Beregn din byturs CO₂e aftryk</h1>
  <br>
  <br>
  <h2>Indtast herunder hvor meget alkohol du har indtaget</h2>

  
  
  <div id="slider1">
  <input type="range" min="0" max="10" value="0" class="slider slider1" id="myRange">
  <p> Øl:  <span id="demo"></span> </p>
</div>

<div id="slider2">
  <input type="range" min="0" max="10" value="0" class="slider slider2" id="myRange2">
  <p>Vin: <span id="demo2"></span></p>
</div>

<div id="slider3">
  <input type="range" min="0" max="10" value="0" class="slider slider3" id="myRange3">
  <p>Drinks: <span id="demo3"></span></p>
</div>

<button type="button" onclick="calculateCO2e();" class="knap">Generer dit CO₂e forbrug</button>
<p id="resultat" style="display:none;"> </p>


<div class="scroll-down"></div>

<div class="main" id="section1">
  
</div>
<!-- det her er vores kasser nederst på siden-->
<div class="boxes">
<div class="rowContainer" id="row">
    <div class="slides">
      <div class="rammer">
        <div class="overbox"><p>Streaming</p>
        <div class="slide-objekt-1 box" onclick="openTab('b1');" >
        
        </div>
        </div>
        <div class="overbox"><p>Transport</p>
        <div class="slide-objekt-2 box" onclick="openTab('b2');">
          <p></p>
        </div>
      </div>
        <div class="overbox"><p>Madvarer</p>
        <div class="slide-objekt-3 box" onclick="openTab('b3');">
          <p></p>
        </div>
      </div>
      </div>
    </div>
</div>


<div class="pop-up">
  <!-- The expanding grid (hidden by default) -->
  <div id="b1" class="containerTab" style="display:none;background: rgb(0, 128, 0)">
    <!-- If you want the ability to close the container, add a close button -->
    <span onclick="this.parentElement.style.display='none'" class="closebtn">x</span>
    <p id="box1"></p>
  </div>
  
  <div id="b2" class="containerTab" style="display:none;background: green">
    <span onclick="this.parentElement.style.display='none'" class="closebtn">x</span>
    <p id="box2"></p>
  </div>
  
  <div id="b3" class="containerTab" style="display:none;background: rgb(0, 128,0)">
    <span onclick="this.parentElement.style.display='none'" class="closebtn">x</span>
    <p id="box3"></p>
  </div>
  </div>
  </div>



 



  <h2>Test din byturs CO2e forbrug mod unge danskere</h2>

  <button type="button" onclick="barrace();" class="knap" id="klik">Start race</button>
   <!--Create a div with just a rect in svg--> 
  <div>
    <svg id="race" width="960px" height="800px">
      <rect id="rectArea1" x="10" y="200" width="0" height="30" stroke="black" fill="#69b3a2" stroke-width="1"/>
      <rect id="rectArea2" x="10" y="250" width="0" height="30" stroke="black" fill="#69b3a2" stroke-width="1"/>
      <text id="textElement1" x="220" y="270" font-size="14" font-weight="bold" fill="black" opacity="0">Du er en fårking svagdrikker!!</text>
      <text id="textElement2" x="220" y="220" font-size="14" font-weight="bold" fill="black" opacity="0">Winner winner Chicken dinner</text>
    </svg>
  </div>

  


<script>


/*
var agePrompt=prompt("Venligst indtast din alder.");

if (agePrompt>=18) {
  alert('Velkommen til vores hjemmeside!')
} else {
  alert('Beklager makker, du er sku for ung!');
  document.location="https://www.sik.dk/erhverv/medicin-og-alderskontrol/alderskontrol/alderskontrol-salg-alkohol";
}
    */
    var slider1 = document.getElementById("myRange");
    var output1 = document.getElementById("demo");
    output1.innerHTML = slider1.value;
  
    slider1.oninput = function() {
      output1.innerHTML = this.value;
    }

    var slider2 = document.getElementById("myRange2");
    var output2 = document.getElementById("demo2");
    output2.innerHTML = slider2.value;

    slider2.oninput = function() {
      output2.innerHTML = this.value;
    }

    var slider3 = document.getElementById("myRange3");
    var output3 = document.getElementById("demo3");
    output3.innerHTML = slider3.value;

    slider3.oninput = function() {
      output3.innerHTML = this.value;
    }

var co2e;

    function calculateCO2e() {
      

  var p = document.getElementById("resultat");
  var oldResult = p.querySelector("p");
  if (oldResult) {
    p.removeChild(oldResult);
  }
  p.style.display = "block";

  // Get the values from the sliders
  var beer = parseInt(document.getElementById("myRange").value).toFixed(2);
  var wine = parseInt(document.getElementById("myRange2").value).toFixed(2);
  var drinks = parseInt(document.getElementById("myRange3").value).toFixed(2);

  

  d3.json ("http://localhost:3000/alkohol").then(function (dataset){  //ændre localhost til server, når den er oppe
  var øl = parseFloat(dataset[0].alko_co2e/2);
  var vin = parseFloat(dataset[2].alko_co2e/6);
  var vodka = parseFloat(dataset[3].alko_co2e/18);

// Calculate the CO2e emissions
    co2e = beer * øl + wine * vin + drinks * vodka;
    co2e = co2e.toFixed(2);


    faktabox1(co2e);
    faktabox2(co2e);
    faktabox3(co2e);

    // var nyco2e = co2e;
   


// Display the result
var result = document.createElement("p");
result.innerHTML = "<span style='font-size: 24px; font-weight: bold;'>Din bytur svarer til " + co2e + " kg CO₂e.</span>";
p.appendChild(result);
}); 
}


// Hide all elements with class="containerTab", except for the one that matches the clickable grid column
function openTab(tabName) {
  var i, x;
  x = document.getElementsByClassName("containerTab");
  for (i = 0; i < x.length; i++) {
    x[i].style.display = "none";
  }
  document.getElementById(tabName).style.display = "block";
}


// Dette er fakta boks 1

function faktabox1(co2e) {

  var p = document.getElementById("box1");
  var oldResult = p.querySelector("p");
  if (oldResult) {
    p.removeChild(oldResult);
  }
  p.style.display = "block";


d3.json ("http://localhost:3000/streaming").then(function (dataset){  //ændre localhost til server, når den er oppe
var streaming = parseFloat(dataset[0].stream_co2e);
var StreamResult = (co2e / streaming).toFixed(2);



// Display the result
var result = document.createElement("p");
result.innerHTML = "<span style='font-size: 24px; font-weight: bold;'>Din bytur svarer til " + StreamResult + " minuters streaming</span>";
p.appendChild(result);
});
}

// Dette er fakta boks 2

function faktabox2(co2e) {

var p = document.getElementById("box2");
var oldResult = p.querySelector("p");
if (oldResult) {
  p.removeChild(oldResult);
}
p.style.display = "block";


d3.json ("http://localhost:3000/transport").then(function (dataset){  //ændre localhost til server, når den er oppe
var transport = parseFloat(dataset[0].trans_co2e);
var transResult = (co2e / transport).toFixed(2);


// Display the result
var result = document.createElement("p");
result.innerHTML = "<span style='font-size: 24px; font-weight: bold;'>Din bytur svarer til " + transResult + " km i bus du kan kører</span>";
p.appendChild(result);
});
}


// Dette er fakta boks 3

function faktabox3(co2e) {

var p = document.getElementById("box3");
var oldResult = p.querySelector("p");
if (oldResult) {
  p.removeChild(oldResult);
}
p.style.display = "block";


d3.json ("http://localhost:3000/madvarer").then(function (dataset){  //ændre localhost til server, når den er oppe
var madvarer = parseFloat(dataset[0].mad_co2e);
var madResult = (co2e / madvarer).toFixed(2);


// Display the result
var result = document.createElement("p");
result.innerHTML = "<span style='font-size: 24px; font-weight: bold;'>Din bytur svarer til " + madResult + " kg kyllingebryst</span>";
p.appendChild(result);
});
}


// Bar chart race nedenfor
function barrace() {
  var gennemsnit = 100; // dette er mock data SKAL ÆNDRES, gennemsnit fra klassen
  console.log(co2e);

  d3.select("#rectArea1")
    .transition()
    .delay(100)
    .duration(2000)
    .attr("width", co2e * 50 + "px");

  d3.select("#rectArea2")
    .transition()
    .delay(100)
    .duration(2000)
    .attr("width", gennemsnit + "px");

  d3.select("#textElement1")
        .transition()
        .delay(2100)
        .duration(500)
        .attr("opacity", "1");

  d3.select("#textElement2")
        .transition()
        .delay(2100)
        .duration(500)
        .attr("opacity", "1");
}



  </script>

</body>
</html>